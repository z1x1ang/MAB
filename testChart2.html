<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q值收敛动态可视化</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- 引入Chart.js库 -->
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #chart-container {
            width: 80%;
            height: 480px;
            margin: auto;
        }
    </style>
</head>
<body>
    <h1>Q值收敛动态可视化</h1>
    <div id="chart-container">
        <canvas id="myChart"></canvas>
    </div>

    <script>
        const trials = 100; // 试验次数
        const trueReward = 0.7; // 真实奖励值
        let qValue = 0; // 初始化Q值

        const labels = [];
        const dataPoints = [];

        // Chart.js图表设置
        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Q值',
                    data: dataPoints,
                    backgroundColor: 'rgba(153, 102, 255, 0.2)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
        // 函数用于添加新的数据点并更新图表
        function addData(chart, label, data) {
            chart.data.labels.push(label);
            chart.data.datasets.forEach((dataset) => {
                dataset.data.push(data);
            });
            chart.update();
        }
        // 模拟每次尝试的操作
        function performTrial(trialNumber) {
            if (trialNumber > trials) {
                return; // 如果达到试验次数上限，则停止
            }
            const reward = Math.random() < trueReward ? 1 : 0; // 随机决定这次尝试是否获得奖励
            qValue += (reward - qValue) / trialNumber; // 更新Q值
            addData(myChart, trialNumber, qValue); // 添加新数据点到图表
            // 设置下一次迭代
            setTimeout(() => {
                performTrial(trialNumber + 1);
            }, 90); // 每0.5秒更新一次
        }
        performTrial(1); // 开始模拟
    </script>
</body>
</html>
